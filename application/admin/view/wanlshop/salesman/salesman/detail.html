<div class="panel panel-default panel-intro">
    <div class="panel-heading">
        <h3 class="panel-title">业务员详情</h3>
    </div>
    <div class="panel-body">
        <!-- 基本信息 -->
        <div class="row">
            <div class="col-md-6">
                <table class="table table-bordered">
                    <tr>
                        <th width="30%">用户昵称</th>
                        <td>{$row.user.nickname ?? '-'}</td>
                    </tr>
                    <tr>
                        <th>手机号</th>
                        <td>{$row.user.mobile ?? '-'}</td>
                    </tr>
                    <tr>
                        <th>返利等级</th>
                        <td>Lv{$row.user.bonus_level ?? 0}</td>
                    </tr>
                    <tr>
                        <th>状态</th>
                        <td>
                            {if $row.status == 'normal'}
                            <span class="label label-success">正常</span>
                            {else}
                            <span class="label label-danger">禁用</span>
                            {/if}
                        </td>
                    </tr>
                    <tr>
                        <th>指定时间</th>
                        <td>{$row.createtime|date='Y-m-d H:i:s',###}</td>
                    </tr>
                </table>
            </div>
            <div class="col-md-6">
                <table class="table table-bordered">
                    <tr>
                        <th width="30%">邀请用户数</th>
                        <td>{$row.stats.invite_user_count ?? 0} （已核销: {$row.stats.invite_user_verified ?? 0}）</td>
                    </tr>
                    <tr>
                        <th>邀请商家数</th>
                        <td>{$row.stats.invite_shop_count ?? 0} （已核销: {$row.stats.invite_shop_verified ?? 0}）</td>
                    </tr>
                    <tr>
                        <th>累计返利</th>
                        <td>¥{$row.stats.total_rebate_amount ?? '0.00'}</td>
                    </tr>
                    <tr>
                        <th>已发放奖励</th>
                        <td>¥{$row.stats.total_reward_amount ?? '0.00'}</td>
                    </tr>
                    <tr>
                        <th>待发放奖励</th>
                        <td>¥{$row.stats.pending_reward_amount ?? '0.00'}</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- 任务进度 -->
        <h4 class="page-header">任务进度</h4>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>任务名称</th>
                    <th>任务类型</th>
                    <th>目标</th>
                    <th>当前进度</th>
                    <th>奖励金额</th>
                    <th>状态</th>
                </tr>
            </thead>
            <tbody>
                {volist name="taskProgress" id="tp"}
                <tr>
                    <td>{$tp.task.name ?? '-'}</td>
                    <td>{$tp.task.type_text ?? '-'}</td>
                    <td>{$tp.task.target_text ?? '-'}</td>
                    <td>
                        {if $tp.task.type == 'rebate_amount'}
                        ¥{$tp.current_amount}
                        {else}
                        {$tp.current_count}个
                        {/if}
                        <span class="text-muted">({$tp.progress_percent}%)</span>
                    </td>
                    <td>¥{$tp.reward_amount}</td>
                    <td>
                        {switch $tp.state}
                        {case 0}<span class="label label-info">进行中</span>{/case}
                        {case 1}<span class="label label-warning">待审核</span>{/case}
                        {case 2}<span class="label label-primary">待发放</span>{/case}
                        {case 3}<span class="label label-success">已发放</span>{/case}
                        {case 4}<span class="label label-default">已取消</span>{/case}
                        {/switch}
                    </td>
                </tr>
                {/volist}
                {if empty($taskProgress)}
                <tr><td colspan="6" class="text-center text-muted">暂无任务</td></tr>
                {/if}
            </tbody>
        </table>

        <!-- 邀请的用户 -->
        <h4 class="page-header">最近邀请的用户</h4>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>昵称</th>
                    <th>手机号</th>
                    <th>注册时间</th>
                </tr>
            </thead>
            <tbody>
                {volist name="invitedUsers" id="user"}
                <tr>
                    <td>{$user.id}</td>
                    <td>{$user.nickname}</td>
                    <td>{$user.mobile}</td>
                    <td>{$user.createtime|date='Y-m-d H:i:s',###}</td>
                </tr>
                {/volist}
                {if empty($invitedUsers)}
                <tr><td colspan="4" class="text-center text-muted">暂无数据</td></tr>
                {/if}
            </tbody>
        </table>

        <!-- 邀请的商家 -->
        <h4 class="page-header">最近邀请的商家</h4>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>店铺名称</th>
                    <th>手机号</th>
                    <th>注册时间</th>
                </tr>
            </thead>
            <tbody>
                {volist name="invitedShops" id="shop"}
                <tr>
                    <td>{$shop.id}</td>
                    <td>{$shop.shopname}</td>
                    <td>{$shop.mobile}</td>
                    <td>{$shop.createtime|date='Y-m-d H:i:s',###}</td>
                </tr>
                {/volist}
                {if empty($invitedShops)}
                <tr><td colspan="4" class="text-center text-muted">暂无数据</td></tr>
                {/if}
            </tbody>
        </table>
    </div>
</div>
