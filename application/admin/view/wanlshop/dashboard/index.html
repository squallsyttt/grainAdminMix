<style type="text/css">
[v-cloak] { display: none }

/* 全局大模块样式 */
.dashboard-module {
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.06);
  margin-bottom: 32px;
  overflow: hidden;
}
.dashboard-module:last-child { margin-bottom: 0; }

/* 模块头部 */
.module-header {
  padding: 20px 32px 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.module-title {
  font-size: 18px;
  font-weight: 700;
  color: #1f2937;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}
.module-title i {
  font-size: 20px;
  opacity: 0.7;
}
.module-subtitle {
  font-size: 13px;
  color: #9ca3af;
  font-weight: 400;
}

/* 模块内容 */
.module-body {
  padding: 24px 32px 28px;
}

/* 概览卡片区 */
.overview-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  padding: 24px 32px;
}
.overview-card {
  border-radius: 12px;
  padding: 20px 24px;
  color: #fff;
  position: relative;
  overflow: hidden;
  min-height: 120px;
}
.overview-card .icon {
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 64px;
  opacity: 0.15;
}
.overview-card .label {
  font-size: 14px;
  opacity: 0.9;
  margin-bottom: 8px;
}
.overview-card .value {
  font-size: 32px;
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 8px;
}
.overview-card .desc {
  font-size: 13px;
  opacity: 0.8;
}
.bg-card-blue { background: linear-gradient(135deg, #2f9de2, #57bdbf); }
.bg-card-red { background: linear-gradient(135deg, #fb2c95, #ff7d7d); }
.bg-card-violet { background: linear-gradient(135deg, #925cc3, #c543d8); }
.bg-card-primary { background: linear-gradient(135deg, #f39526, #ecca1b); }

/* 财务数据网格 */
.finance-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0;
}
.finance-item {
  padding: 24px 32px;
  border-right: 1px solid #f0f0f0;
  text-align: center;
}
.finance-item:last-child { border-right: none; }
.finance-label {
  font-size: 14px;
  color: #6b7280;
  margin-bottom: 12px;
  font-weight: 500;
}
.finance-value {
  font-size: 28px;
  font-weight: 700;
  color: #1f2937;
  line-height: 1.2;
  margin-bottom: 8px;
}
.finance-desc {
  font-size: 12px;
  color: #9ca3af;
}

/* 业务数据双栏 */
.business-split {
  display: grid;
  grid-template-columns: 1fr 1fr;
}
.business-section {
  padding: 24px 32px;
}
.business-section:first-child {
  border-right: 1px solid #f0f0f0;
}
.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid #f5f5f5;
}
.section-title {
  font-size: 16px;
  font-weight: 600;
  color: #374151;
}
.section-unit {
  font-size: 12px;
  color: #9ca3af;
}
.data-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px 24px;
}
.data-item {
  text-align: left;
}
.data-label {
  font-size: 13px;
  color: #6b7280;
  margin-bottom: 6px;
}
.data-value {
  font-size: 18px;
  font-weight: 600;
  color: #111827;
}

/* 运营状态三栏 */
.ops-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
}
.ops-section {
  padding: 24px 32px;
  border-right: 1px solid #f0f0f0;
}
.ops-section:last-child { border-right: none; }
.ops-title {
  font-size: 16px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 1px solid #f5f5f5;
}
.ops-data {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}
.ops-item .data-label {
  margin-bottom: 4px;
}
.ops-item .data-value {
  font-size: 15px;
}

/* 列表模块 */
.list-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
}
.list-section {
  padding: 24px 32px;
  border-right: 1px solid #f0f0f0;
}
.list-section:last-child { border-right: none; }
.list-title {
  font-size: 16px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 16px;
}
.list-table {
  width: 100%;
}
.list-table thead {
  color: #6b7280;
  font-size: 13px;
}
.list-table th, .list-table td {
  padding: 10px 8px;
  font-size: 13px;
  line-height: 1.5;
}
.list-table tbody tr {
  border-bottom: 1px solid #f5f5f5;
}
.list-table tbody tr:last-child { border-bottom: none; }
.list-table tbody td:first-child { color: #666; }

/* 响应式 */
@media (max-width: 1200px) {
  .overview-grid { grid-template-columns: repeat(2, 1fr); }
  .finance-grid { grid-template-columns: repeat(2, 1fr); }
  .finance-item:nth-child(2) { border-right: none; }
  .finance-item:nth-child(1), .finance-item:nth-child(2) { border-bottom: 1px solid #f0f0f0; }
}
@media (max-width: 992px) {
  .business-split { grid-template-columns: 1fr; }
  .business-section:first-child { border-right: none; border-bottom: 1px solid #f0f0f0; }
  .ops-grid { grid-template-columns: 1fr; }
  .ops-section { border-right: none; border-bottom: 1px solid #f0f0f0; }
  .ops-section:last-child { border-bottom: none; }
  .list-grid { grid-template-columns: 1fr; }
  .list-section { border-right: none; border-bottom: 1px solid #f0f0f0; }
  .list-section:last-child { border-bottom: none; }
}
@media (max-width: 768px) {
  .overview-grid { grid-template-columns: 1fr; }
  .finance-grid { grid-template-columns: 1fr; }
  .finance-item { border-right: none; border-bottom: 1px solid #f0f0f0; }
  .finance-item:last-child { border-bottom: none; }
  .data-grid { grid-template-columns: repeat(2, 1fr); }
  .module-header, .module-body { padding-left: 20px; padding-right: 20px; }
  .overview-grid, .finance-item, .business-section, .ops-section, .list-section { padding-left: 20px; padding-right: 20px; }
}

/* 趋势图模块样式 */
.trend-filter {
  display: flex;
  align-items: center;
  gap: 12px;
}
.trend-select {
  padding: 8px 16px;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  font-size: 14px;
  color: #374151;
  background: #fff;
  cursor: pointer;
  outline: none;
}
.trend-select:focus {
  border-color: #3c8dbc;
}
.trend-btn {
  padding: 8px 16px;
  border: 1px solid #3c8dbc;
  border-radius: 6px;
  font-size: 14px;
  color: #3c8dbc;
  background: #fff;
  cursor: pointer;
  transition: all 0.2s;
}
.trend-btn:hover {
  background: #3c8dbc;
  color: #fff;
}
.trend-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
}
.trend-chart-box {
  background: #fafafa;
  border-radius: 12px;
  padding: 20px;
}
.trend-chart-title {
  font-size: 15px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 16px;
}
.trend-chart {
  height: 280px;
  width: 100%;
}
@media (max-width: 992px) {
  .trend-grid { grid-template-columns: 1fr; }
}
</style>

<div class="alert alert-success-light" style="margin-bottom: 24px; border-radius: 12px;">
    <i class="fa fa-warning"></i> 温馨提示：后台订单列表仅供查看，如需发货、修改订单信息，或需要添加新商家，请注册账户登录 <a target="_blank" href="/index/wanlshop.console">进入商家后台</a> 操作
</div>

<!-- 模块1：概览区 -->
<div class="dashboard-module">
    <div class="overview-grid">
        <div class="overview-card bg-card-blue">
            <div class="icon"><i class="fa fa-sitemap"></i></div>
            <div class="label">店铺</div>
            <div class="value">{$totalShop}</div>
            <div class="desc">商城店铺总数量</div>
        </div>
        <div class="overview-card bg-card-red">
            <div class="icon"><i class="fa fa-shopping-cart"></i></div>
            <div class="label">商品</div>
            <div class="value">{$totalGoods}</div>
            <div class="desc">商城店铺商品总和</div>
        </div>
        <div class="overview-card bg-card-violet">
            <div class="icon"><i class="fa fa-user-circle"></i></div>
            <div class="label">会员</div>
            <div class="value">{$totalUser}</div>
            <div class="desc">平台注册会员总数</div>
        </div>
        <div class="overview-card bg-card-primary">
            <div class="icon"><i class="fa fa-user"></i></div>
            <div class="label">今日会员</div>
            <div class="value">{$totalDayUser}</div>
            <div class="desc">今日新增用户数量</div>
        </div>
    </div>
</div>

<!-- 模块2：财务概览 -->
<div class="dashboard-module">
    <div class="module-header">
        <h3 class="module-title"><i class="fa fa-line-chart"></i> 财务概览</h3>
        <span class="module-subtitle">核销券业务数据统计</span>
    </div>
    <div class="finance-grid">
        <div class="finance-item">
            <div class="finance-label">核销券总流水</div>
            <div class="finance-value">￥{$platformTotalAmount|sprintf='%.2f',###}</div>
            <div class="finance-desc">实付金额（含退款订单）</div>
        </div>
        <div class="finance-item">
            <div class="finance-label">今日流水</div>
            <div class="finance-value">￥{$platformTodayAmount|sprintf='%.2f',###}</div>
            <div class="finance-desc">今日付款订单</div>
        </div>
        <div class="finance-item">
            <div class="finance-label">平台利润累计</div>
            <div class="finance-value">￥{$platformProfitTotal|sprintf='%.2f',###}</div>
            <div class="finance-desc">结算记录汇总</div>
        </div>
        <div class="finance-item">
            <div class="finance-label">已结算利润</div>
            <div class="finance-value">￥{$platformProfitSettled|sprintf='%.2f',###}</div>
            <div class="finance-desc">state=已结算</div>
        </div>
    </div>
</div>

<!-- 历史数据趋势图 -->
<div class="dashboard-module" id="trend-charts">
    <div class="module-header">
        <h3 class="module-title"><i class="fa fa-area-chart"></i> 历史数据趋势</h3>
        <div class="trend-filter">
            <select id="trend-days" class="trend-select">
                <option value="7">近7天</option>
                <option value="14">近14天</option>
                <option value="30" selected>近30天</option>
                <option value="60">近60天</option>
                <option value="90">近90天</option>
            </select>
            <button id="refresh-trend" class="trend-btn"><i class="fa fa-refresh"></i> 刷新</button>
        </div>
    </div>
    <div class="module-body">
        <div class="trend-grid">
            <div class="trend-chart-box">
                <div class="trend-chart-title">每日流水 / 订单数</div>
                <div id="chart-order" class="trend-chart"></div>
            </div>
            <div class="trend-chart-box">
                <div class="trend-chart-title">每日核销金额 / 核销数量</div>
                <div id="chart-verify" class="trend-chart"></div>
            </div>
            <div class="trend-chart-box">
                <div class="trend-chart-title">每日退款金额</div>
                <div id="chart-refund" class="trend-chart"></div>
            </div>
            <div class="trend-chart-box">
                <div class="trend-chart-title">每日新增用户</div>
                <div id="chart-users" class="trend-chart"></div>
            </div>
        </div>
    </div>
</div>

<!-- 模块3：业务数据 -->
<div class="dashboard-module">
    <div class="module-header">
        <h3 class="module-title"><i class="fa fa-bar-chart"></i> 业务数据</h3>
    </div>
    <div class="business-split">
        <div class="business-section">
            <div class="section-header">
                <span class="section-title">核销券订单</span>
                <span class="section-unit">单位：单 / 元</span>
            </div>
            <div class="data-grid">
                <div class="data-item">
                    <div class="data-label">总订单</div>
                    <div class="data-value">{$totalVoucherOrder} 单</div>
                </div>
                <div class="data-item">
                    <div class="data-label">已支付</div>
                    <div class="data-value">{$paidVoucherOrder} 单</div>
                </div>
                <div class="data-item">
                    <div class="data-label">待支付</div>
                    <div class="data-value">{$unpaidVoucherOrder} 单</div>
                </div>
                <div class="data-item">
                    <div class="data-label">已取消</div>
                    <div class="data-value">{$cancelVoucherOrder} 单</div>
                </div>
                <div class="data-item">
                    <div class="data-label">今日新增</div>
                    <div class="data-value">{$todayVoucherOrder} 单</div>
                </div>
                <div class="data-item">
                    <div class="data-label">今日流水</div>
                    <div class="data-value">￥{$platformTodayAmount|sprintf='%.2f',###}</div>
                </div>
            </div>
        </div>
        <div class="business-section">
            <div class="section-header">
                <span class="section-title">核销券</span>
                <span class="section-unit">单位：张 / 元</span>
            </div>
            <div class="data-grid">
                <div class="data-item">
                    <div class="data-label">总券量</div>
                    <div class="data-value">{$totalVoucher} 张</div>
                </div>
                <div class="data-item">
                    <div class="data-label">待核销</div>
                    <div class="data-value">{$voucherUnused} 张</div>
                </div>
                <div class="data-item">
                    <div class="data-label">已核销</div>
                    <div class="data-value">{$voucherVerified} 张</div>
                </div>
                <div class="data-item">
                    <div class="data-label">今日核销</div>
                    <div class="data-value">{$voucherVerifiedTodayCount} 张</div>
                </div>
                <div class="data-item">
                    <div class="data-label">今日核销额</div>
                    <div class="data-value">￥{$voucherVerifiedTodayAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="data-item">
                    <div class="data-label">累计核销额</div>
                    <div class="data-value">￥{$voucherVerifiedAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="data-item">
                    <div class="data-label">已过期</div>
                    <div class="data-value">{$voucherExpired} 张</div>
                </div>
                <div class="data-item">
                    <div class="data-label">退款中/已退</div>
                    <div class="data-value">{$voucherRefunded} 张</div>
                </div>
                <div class="data-item">
                    <div class="data-label">今日核销记录</div>
                    <div class="data-value">{$todayVerificationCount} 条</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 模块4：运营状态 -->
<div class="dashboard-module">
    <div class="module-header">
        <h3 class="module-title"><i class="fa fa-cogs"></i> 运营状态</h3>
    </div>
    <div class="ops-grid">
        <div class="ops-section">
            <div class="ops-title">结算</div>
            <div class="ops-data">
                <div class="ops-item">
                    <div class="data-label">待结算</div>
                    <div class="data-value">{$settlementPendingCount} 笔 / ￥{$settlementPendingAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">已结算</div>
                    <div class="data-value">{$settlementPaidCount} 笔 / ￥{$settlementPaidAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">打款中</div>
                    <div class="data-value">{$settlementPayingCount} 笔</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">打款失败</div>
                    <div class="data-value">{$settlementFailedCount} 笔</div>
                </div>
            </div>
        </div>
        <div class="ops-section">
            <div class="ops-title">返利</div>
            <div class="ops-data">
                <div class="ops-item">
                    <div class="data-label">累计返利</div>
                    <div class="data-value">￥{$rebateTotalAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">已打款</div>
                    <div class="data-value">{$rebatePaidCount} 笔 / ￥{$rebatePaidAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">待打款</div>
                    <div class="data-value">{$rebatePendingCount} 笔 / ￥{$rebatePendingAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">打款失败</div>
                    <div class="data-value">{$rebateFailedCount} 笔</div>
                </div>
            </div>
        </div>
        <div class="ops-section">
            <div class="ops-title">退款</div>
            <div class="ops-data">
                <div class="ops-item">
                    <div class="data-label">申请中</div>
                    <div class="data-value">{$refundApplyingCount} 笔</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">已同意</div>
                    <div class="data-value">{$refundAgreeCount} 笔</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">已拒绝</div>
                    <div class="data-value">{$refundRefuseCount} 笔</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">退款成功</div>
                    <div class="data-value">{$refundSuccessCount} 笔 / ￥{$refundSuccessAmount|sprintf='%.2f',###}</div>
                </div>
                <div class="ops-item">
                    <div class="data-label">今日退款</div>
                    <div class="data-value">￥{$refundTodayAmount|sprintf='%.2f',###}</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 模块5：数据列表 -->
<div class="dashboard-module" id="wanlshop" v-cloak>
    <div class="module-header">
        <h3 class="module-title"><i class="fa fa-list"></i> 数据列表</h3>
    </div>
    <div class="list-grid">
        <div class="list-section">
            <div class="list-title">TOP10 销量</div>
            <table class="list-table">
                <thead>
                    <tr>
                        <th class="text-left">商品名称</th>
                        <th class="text-right" width="60px">销量</th>
                    </tr>
                </thead>
                <tbody>
                    {foreach name="goodsTopList" id="item" empty="<tr><td colspan='2' class='text-center' style='color:#999;padding:20px 0;'>暂无数据</td></tr>"}
                    <tr>
                        <td class="text-left">{$key+1}. {$item.title}</td>
                        <td class="text-right">{$item.sales}</td>
                    </tr>
                    {/foreach}
                </tbody>
            </table>
        </div>
        <div class="list-section">
            <div class="list-title">新申请店铺</div>
            <table class="list-table">
                <thead>
                    <tr>
                        <th class="text-left">店铺名</th>
                        <th class="text-center">类型</th>
                        <th class="text-center">状态</th>
                        <th width="96px" class="text-center">操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(item, index) in shopAuthList" :key="index">
                        <td class="text-left" @click="shopDetails(index)">{{item.shopname}}</td>
                        <td class="text-center">{{shopState[item.state]}}</td>
                        <td class="text-center">{{shopVerify[item.verify]}}</td>
                        <td class="text-right">
                            <span class="btn btn-xs btn-success" @click="shopAgree(index)"><i class="fa fa-check"></i></span>
                            <span class="btn btn-xs btn-danger" @click="shopRefuse(index)"><i class="fa fa-times"></i></span>
                            <span class="btn btn-xs btn-info" @click="shopDetails(index)"><i class="fa fa-eye"></i></span>
                        </td>
                    </tr>
                    <tr v-if="shopAuthList.length == 0"><td colspan='4' class='text-center' style='color:#999;padding:20px 0;'>暂无数据</td></tr>
                </tbody>
            </table>
        </div>
        <div class="list-section">
            <div class="list-title">介入退款</div>
            <table class="list-table">
                <thead>
                    <tr>
                        <th class="text-left">订单号</th>
                        <th class="text-center">金额</th>
                        <th class="text-center">状态</th>
                        <th width="96px" class="text-center">操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(item, index) in refundList" :key="index">
                        <td class="text-left" @click="refundDetails(index)">{{item.pay.order_no}}</td>
                        <td class="text-center">{{item.price}}</td>
                        <td class="text-center">{{refundState[item.state]}}</td>
                        <td class="text-right">
                            <span class="btn btn-xs btn-info" @click="refundDetails(index)"><i class="fa fa-eye"></i></span>
                            <span class="btn btn-xs btn-success" @click="refundAgree(index)"><i class="fa fa-check"></i></span>
                            <span class="btn btn-xs btn-danger" @click="refundRefuse(index)"><i class="fa fa-times"></i></span>
                        </td>
                    </tr>
                    <tr v-if="refundList.length == 0"><td colspan='4' class='text-center' style='color:#999;padding:20px 0;'>暂无数据</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div style="height: 32px;"></div>
