<div class="panel panel-default panel-intro">
    <div class="panel-heading">
        <div class="panel-lead"><em>统计与结算</em>BD推广员数据统计和佣金结算管理</div>
        <ul class="nav nav-tabs">
            <li class="active"><a href="#tab-overview" data-toggle="tab">数据概览</a></li>
            <li><a href="#tab-detail" data-toggle="tab">流水明细</a></li>
        </ul>
    </div>
    <div class="panel-body">
        <div class="tab-content">
            <!-- 数据概览 Tab -->
            <div class="tab-pane active" id="tab-overview">
                <style>
                .overview-section { margin-bottom: 30px; }
                .section-title { font-size: 16px; font-weight: 600; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
                .section-title i { margin-right: 8px; color: #666; }
                .time-filter { margin-bottom: 20px; }
                .stats-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; margin-bottom: 20px; }
                .stat-card { background: #fff; border: 1px solid #e9ecef; border-radius: 6px; padding: 15px; text-align: center; }
                .stat-card .value { font-size: 24px; font-weight: bold; margin-bottom: 3px; }
                .stat-card .label { font-size: 13px; color: #666; }
                .stat-card.green .value { color: #28a745; }
                .stat-card.blue .value { color: #1890ff; }
                .stat-card.orange .value { color: #fa8c16; }
                @media (max-width: 1200px) { .stats-grid { grid-template-columns: repeat(3, 1fr); } }
                @media (max-width: 768px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
                </style>

                <!-- 时间筛选 -->
                <div class="time-filter">
                    <div class="btn-group">
                        <button type="button" class="btn btn-default btn-time-filter active" data-type="today">今日</button>
                        <button type="button" class="btn btn-default btn-time-filter" data-type="3days">近3天</button>
                        <button type="button" class="btn btn-default btn-time-filter" data-type="7days">近7天</button>
                        <button type="button" class="btn btn-default btn-time-filter" data-type="30days">近30天</button>
                    </div>
                    <span id="overview-loading" style="margin-left: 15px; display: none;"><i class="fa fa-spinner fa-spin"></i> 加载中...</span>
                </div>

                <!-- 统计卡片 -->
                <div class="overview-section">
                    <div class="stats-grid">
                        <div class="stat-card blue">
                            <div class="value" id="stat-new-bd">-</div>
                            <div class="label">新增BD</div>
                        </div>
                        <div class="stat-card green">
                            <div class="value" id="stat-new-shop">-</div>
                            <div class="label">新增店铺绑定</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="value" id="stat-active-bd">-</div>
                            <div class="label">活跃BD数</div>
                        </div>
                        <div class="stat-card green">
                            <div class="value" id="stat-total-commission">-</div>
                            <div class="label">产生佣金</div>
                        </div>
                        <div class="stat-card">
                            <div class="value" id="stat-deduct-commission">-</div>
                            <div class="label">扣减佣金</div>
                        </div>
                        <div class="stat-card blue">
                            <div class="value" id="stat-net-commission">-</div>
                            <div class="label">净佣金</div>
                        </div>
                    </div>
                </div>

                <!-- BD排行榜 -->
                <div class="overview-section">
                    <div class="section-title"><i class="fa fa-trophy"></i> BD佣金排行榜 (TOP 10)</div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th width="60">排名</th>
                                <th>BD用户</th>
                                <th>推广码</th>
                                <th width="120">佣金金额</th>
                            </tr>
                        </thead>
                        <tbody id="top-bd-list">
                            <tr><td colspan="4" class="text-center text-muted">加载中...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 流水明细 Tab -->
            <div class="tab-pane" id="tab-detail">
                <style>
                .filter-row { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px; }
                .filter-row .form-group { margin-bottom: 0; }
                .filter-row label { font-weight: 500; margin-bottom: 5px; display: block; font-size: 13px; }
                .summary-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-bottom: 20px; }
                .summary-card { background: #fff; border: 1px solid #e9ecef; border-radius: 6px; padding: 15px; text-align: center; }
                .summary-card .value { font-size: 24px; font-weight: bold; margin-bottom: 3px; }
                .summary-card .label { font-size: 13px; color: #666; }
                .summary-card.green .value { color: #28a745; }
                .summary-card.red .value { color: #dc3545; }
                .summary-card.orange .value { color: #fd7e14; }
                .summary-card.blue .value { color: #007bff; }
                @media (max-width: 1200px) { .summary-row { grid-template-columns: repeat(3, 1fr); } }
                @media (max-width: 768px) { .summary-row { grid-template-columns: repeat(2, 1fr); } }
                </style>

                <!-- 筛选条件 -->
                <div class="filter-row">
                    <div class="form-group">
                        <label>推广员</label>
                        <select id="bd-select" class="form-control" style="width: 180px;">
                            <option value="">全部BD</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>邀请店铺</label>
                        <select id="shop-select" class="form-control" style="width: 180px;">
                            <option value="">全部店铺</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>开始日期</label>
                        <input type="date" id="start-date" class="form-control" style="width: 150px;">
                    </div>
                    <div class="form-group">
                        <label>结束日期</label>
                        <input type="date" id="end-date" class="form-control" style="width: 150px;">
                    </div>
                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button type="button" id="btn-search" class="btn btn-primary"><i class="fa fa-search"></i> 查询</button>
                    </div>
                    <span id="detail-loading" style="display: flex; align-items: flex-end; display: none;"><i class="fa fa-spinner fa-spin"></i></span>
                </div>

                <!-- 汇总数据 -->
                <div class="summary-row" style="grid-template-columns: repeat(4, 1fr);">
                    <div class="summary-card">
                        <div class="value" id="summary-earn-count">0</div>
                        <div class="label">收入笔数</div>
                    </div>
                    <div class="summary-card green">
                        <div class="value" id="summary-earn-amount">¥0.00</div>
                        <div class="label">总收入</div>
                    </div>
                    <div class="summary-card red">
                        <div class="value" id="summary-deduct-amount">¥0.00</div>
                        <div class="label">扣减金额</div>
                    </div>
                    <div class="summary-card blue">
                        <div class="value" id="summary-net-amount">¥0.00</div>
                        <div class="label">净收入</div>
                    </div>
                </div>

                <!-- 流水明细表格 -->
                <div class="table-responsive">
                    <table class="table table-striped table-bordered" style="font-size: 13px;">
                        <thead>
                            <tr>
                                <th width="140">时间</th>
                                <th width="130">推广员</th>
                                <th width="65">周期</th>
                                <th>核销券</th>
                                <th width="85">类型</th>
                                <th>计算公式</th>
                                <th width="80">金额</th>
                            </tr>
                        </thead>
                        <tbody id="settlement-list">
                            <tr><td colspan="7" class="text-center text-muted">加载中...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
